import matplotlib.pyplot as plt
from training.training_utils import plot_fit, FitResult

if __name__ == "__main__":
    fit_results = []
    res_names = ["LSTM", "TCN", "LSTM w/ GDELT", "TCN w/ GDELT"]
    n_epochs = 60

    
    train_losses = [0.7374275138503626, 0.72930214593285, 0.7222618178317421, 0.7171939234984549, 0.713377877285606, 0.7051033314905668, 0.6962239930504247, 0.685621838820608, 0.6919081963990864, 0.6793713789237174, 0.6750176862666482, 0.672555713277114, 0.6617652836598849, 0.6633197226022419, 0.6590806935962877, 0.6358512577257658, 0.6495422187604403, 0.6520221735301771, 0.6452338068108809, 0.6450507672209489, 0.6343642598704288, 0.6282311332853217, 0.6406853418601187, 0.6314653973830374, 0.6362702532818443, 0.6341605845250582, 0.6171392641569439, 0.628255053570396, 0.6152828273020292, 0.601872161815041, 0.6206252041615938, 0.6019579768180847, 0.6094520437090021, 0.6194722432839243, 0.5914719732184159, 0.589821435903248, 0.5986020941483347, 0.5987071818427036, 0.5929221244234788, 0.599313243439323, 0.5924945254074899, 0.6051444191681711, 0.5827955258520026, 0.5911756738236076, 0.5820732681374801, 0.5840317371644472, 0.5870046019554138, 0.5969608504521219, 0.5883140407110515, 0.5806803687622673, 0.5897139812770643, 0.57089953046096, 0.5816370060569361, 0.5812909587433464, 0.5750535271669689, 0.5776864117697665, 0.5883272462769559, 0.5723285722105127, 0.5794412634874645, 0.5698633790016174]
    train_accs = [36.0, 36.666666666666664, 41.333333333333336, 42.666666666666664, 46.0, 46.666666666666664, 52.0, 56.0, 51.333333333333336, 56.0, 56.0, 60.0, 68.66666666666667, 59.333333333333336, 64.66666666666667, 72.0, 67.33333333333333, 66.0, 66.66666666666667, 66.66666666666667, 68.0, 70.0, 64.66666666666667, 70.0, 65.33333333333333, 70.66666666666667, 72.0, 70.0, 70.66666666666667, 75.33333333333333, 70.0, 72.66666666666667, 71.33333333333333, 70.66666666666667, 77.33333333333333, 74.66666666666667, 74.0, 77.33333333333333, 74.0, 74.66666666666667, 75.33333333333333, 72.66666666666667, 75.33333333333333, 76.66666666666667, 77.33333333333333, 76.0, 76.66666666666667, 72.0, 76.0, 76.66666666666667, 72.0, 74.66666666666667, 74.0, 74.0, 75.33333333333333, 76.66666666666667, 74.66666666666667, 76.66666666666667, 76.0, 76.66666666666667]
    test_losses = [0.7136366724967956, 0.7332553267478943, 0.7262696146965026, 0.7197237730026245, 0.7197344541549683, 0.70526624917984, 0.6934152960777282, 0.692409074306488, 0.6798434138298035, 0.6779621124267579, 0.6715304970741272, 0.6597304224967957, 0.6592405438423157, 0.6591440081596375, 0.6577850937843323, 0.6441988468170166, 0.6441237330436707, 0.6407984018325805, 0.6351690292358398, 0.6376750111579895, 0.6333836913108826, 0.6212097883224488, 0.6166878938674927, 0.6125120878219604, 0.6214910030364991, 0.616898775100708, 0.6151649355888367, 0.6077858567237854, 0.6042252898216247, 0.6046707153320312, 0.6007256150245667, 0.600355076789856, 0.6094998002052308, 0.598365581035614, 0.5989353656768799, 0.5937016487121582, 0.5976114869117737, 0.5963546395301819, 0.5953922033309936, 0.594351053237915, 0.5896128058433533, 0.5884654343128204, 0.5868224680423737, 0.591614592075348, 0.5908701002597809, 0.5908514380455017, 0.5879466354846954, 0.5830216526985168, 0.583206444978714, 0.5804580867290496, 0.5844343483448029, 0.5838865518569947, 0.5774491190910339, 0.580632996559143, 0.5814621448516846, 0.5844260036945343, 0.579392808675766, 0.5818241536617279, 0.5818539917469024, 0.5816441118717194]
    test_accs = [31.57894736842105, 34.21052631578947, 36.8421052631579, 42.10526315789474, 36.8421052631579, 39.473684210526315, 47.36842105263158, 55.26315789473684, 52.63157894736842, 55.26315789473684, 60.526315789473685, 65.78947368421052, 63.1578947368421, 63.1578947368421, 65.78947368421052, 78.94736842105263, 68.42105263157895, 76.3157894736842, 73.6842105263158, 73.6842105263158, 73.6842105263158, 76.3157894736842, 76.3157894736842, 76.3157894736842, 71.05263157894737, 68.42105263157895, 76.3157894736842, 73.6842105263158, 71.05263157894737, 76.3157894736842, 71.05263157894737, 71.05263157894737, 68.42105263157895, 68.42105263157895, 71.05263157894737, 71.05263157894737, 71.05263157894737, 71.05263157894737, 68.42105263157895, 68.42105263157895, 71.05263157894737, 71.05263157894737, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158]
    fit_results.append(FitResult(n_epochs, train_losses, train_accs, test_losses, test_accs))

    train_losses = [0.7797033629919353, 0.7743947286354868, 0.7585915107476083, 0.7477250256036457, 0.748857275435799, 0.7570197550874007, 0.7447641178181297, 0.7208589880090011, 0.7392208638944124, 0.7148853383566204, 0.7143829433541549, 0.70962571470361, 0.6931252761891014, 0.6971117728634885, 0.6930767580082542, 0.6845829957409909, 0.6792765542080528, 0.6755813548439428, 0.6714304215029666, 0.6617845485084936, 0.6651292537388048, 0.6563800887057656, 0.6707212423023424, 0.6531402186343545, 0.6589151777719197, 0.6525051907489174, 0.663528960002096, 0.6295155694610194, 0.6290362916494671, 0.6341562051522104, 0.6248238494521693, 0.6381973937938088, 0.6182246710124769, 0.6255200348402324, 0.6249136736518458, 0.6272094437950536, 0.6068793848941201, 0.6140755320850172, 0.6178172293462252, 0.6315377982039201, 0.6249100691393802, 0.6071424797961587, 0.5949963644931191, 0.6093305286608244, 0.6076152795239499, 0.5943249464035034, 0.6062847313128019, 0.6044057168458637, 0.5905963307932803, 0.5903959023325067, 0.5846029865114313, 0.5891505793521279, 0.5968437916354129, 0.5913746670672768, 0.5836119589052702, 0.5911313797298231, 0.5826240025068584, 0.5914018812932467, 0.5885812169627139, 0.5895859489315435]
    train_accs = [28.666666666666668, 35.333333333333336, 35.333333333333336, 34.666666666666664, 35.333333333333336, 32.666666666666664, 37.333333333333336, 38.666666666666664, 37.333333333333336, 44.0, 45.333333333333336, 46.666666666666664, 53.333333333333336, 52.666666666666664, 56.0, 50.0, 58.0, 58.666666666666664, 64.0, 63.333333333333336, 59.333333333333336, 62.666666666666664, 56.666666666666664, 65.33333333333333, 62.666666666666664, 64.66666666666667, 59.333333333333336, 69.33333333333333, 68.66666666666667, 67.33333333333333, 69.33333333333333, 66.0, 74.66666666666667, 68.66666666666667, 70.66666666666667, 67.33333333333333, 75.33333333333333, 75.33333333333333, 71.33333333333333, 69.33333333333333, 70.0, 74.66666666666667, 76.0, 75.33333333333333, 71.33333333333333, 75.33333333333333, 74.0, 72.66666666666667, 77.33333333333333, 72.66666666666667, 76.66666666666667, 74.66666666666667, 73.33333333333333, 74.66666666666667, 73.33333333333333, 73.33333333333333, 74.0, 71.33333333333333, 74.0, 69.33333333333333]
    test_losses = [0.716609251499176, 0.7410471796989441, 0.7489396572113037, 0.7424090504646301, 0.7370968818664551, 0.735189926624298, 0.7375526666641236, 0.7366684436798095, 0.7273298978805542, 0.7030276179313659, 0.6932535648345948, 0.6972780704498291, 0.6946977257728577, 0.6807771563529968, 0.6737408518791199, 0.6774895668029786, 0.6704408407211304, 0.6611954092979431, 0.6561857461929321, 0.6592136859893799, 0.6471067309379578, 0.6392641186714172, 0.6440268635749817, 0.6360534310340882, 0.6401286244392395, 0.6300360083580017, 0.6292357206344604, 0.6201207280158997, 0.6288226485252381, 0.6234334349632263, 0.6187558174133301, 0.6160234928131103, 0.6184370160102844, 0.6154251575469971, 0.6150511264801025, 0.6051955223083496, 0.6058197498321534, 0.6018361210823059, 0.6019937753677368, 0.600200867652893, 0.5911616921424866, 0.592758858203888, 0.5905025601387024, 0.5922042846679687, 0.5891497611999512, 0.5844455003738404, 0.5895672798156738, 0.5818512797355652, 0.5795368432998658, 0.5791378736495971, 0.5786387085914612, 0.5810794353485107, 0.585069453716278, 0.5759683668613433, 0.5765967190265655, 0.5788735151290894, 0.5788669645786285, 0.5745912790298462, 0.5722881197929383, 0.5698146522045135]
    test_accs = [26.31578947368421, 31.57894736842105, 34.21052631578947, 44.73684210526316, 39.473684210526315, 44.73684210526316, 39.473684210526315, 50.0, 50.0, 52.63157894736842, 50.0, 50.0, 52.63157894736842, 55.26315789473684, 55.26315789473684, 52.63157894736842, 55.26315789473684, 60.526315789473685, 60.526315789473685, 60.526315789473685, 63.1578947368421, 68.42105263157895, 68.42105263157895, 76.3157894736842, 76.3157894736842, 78.94736842105263, 76.3157894736842, 78.94736842105263, 73.6842105263158, 73.6842105263158, 78.94736842105263, 84.21052631578948, 78.94736842105263, 81.57894736842105, 76.3157894736842, 81.57894736842105, 78.94736842105263, 78.94736842105263, 78.94736842105263, 81.57894736842105, 78.94736842105263, 78.94736842105263, 81.57894736842105, 81.57894736842105, 81.57894736842105, 81.57894736842105, 78.94736842105263, 81.57894736842105, 73.6842105263158, 78.94736842105263, 78.94736842105263, 78.94736842105263, 81.57894736842105, 78.94736842105263, 76.3157894736842, 78.94736842105263, 73.6842105263158, 78.94736842105263, 78.94736842105263, 78.94736842105263]
    fit_results.append(FitResult(n_epochs, train_losses, train_accs, test_losses, test_accs))

    train_losses = [0.62750863715222, 0.6500316262245178, 0.6363338451636465, 0.6238988355586403, 0.6301957180625514, 0.6277187403879667, 0.6387874609545657, 0.6247208902710363, 0.6284744268969485, 0.624202332998577, 0.6166217295747054, 0.6156831697413796, 0.6140852539162887, 0.6028799477376436, 0.6069603248646385, 0.6135872069158053, 0.6167186686867162, 0.5993805119865819, 0.5963996146854601, 0.5963659694320277, 0.5940028727054596, 0.6008231263411673, 0.6088522013865019, 0.6070340714956585, 0.5910342006306899, 0.5890365321385232, 0.5824624362744784, 0.5983940362930298, 0.5967746031911749, 0.5930452095834833, 0.5871903645364862, 0.5898032219786393, 0.5835338093732533, 0.5820011606341914, 0.5801213289562025, 0.5828670388773868, 0.5883122227693859, 0.5843986617891412, 0.5885776297042244, 0.5781233938116777, 0.5780060008952492, 0.5912853212733018, 0.5773349765099978, 0.572183326670998, 0.5825264328404477, 0.5677416654009568, 0.5718394831607216, 0.5733657777309418, 0.5763757087682423, 0.5741858780384064, 0.5598363829286475, 0.571043212162821, 0.5794715771549627, 0.5690670327136391, 0.5690951582632566, 0.5571349074966029, 0.5644858542241549, 0.558770184454165, 0.5653056455285925, 0.5490970564515967]
    train_accs = [73.33333333333333, 68.0, 69.33333333333333, 72.0, 70.0, 69.33333333333333, 70.0, 71.33333333333333, 73.33333333333333, 70.66666666666667, 76.0, 72.66666666666667, 70.66666666666667, 72.66666666666667, 73.33333333333333, 72.66666666666667, 70.0, 73.33333333333333, 72.0, 74.66666666666667, 70.0, 71.33333333333333, 72.0, 72.0, 74.0, 72.0, 74.0, 73.33333333333333, 74.66666666666667, 74.66666666666667, 74.66666666666667, 74.66666666666667, 75.33333333333333, 72.66666666666667, 76.66666666666667, 74.66666666666667, 73.33333333333333, 74.66666666666667, 74.0, 74.0, 74.0, 72.66666666666667, 73.33333333333333, 76.0, 72.66666666666667, 72.0, 75.33333333333333, 74.66666666666667, 74.0, 73.33333333333333, 77.33333333333333, 76.0, 74.66666666666667, 76.0, 74.0, 76.0, 74.66666666666667, 76.66666666666667, 76.0, 76.66666666666667]
    test_losses = [0.6583032608032227, 0.6423352599143982, 0.6303748726844788, 0.6187987208366394, 0.6168873190879822, 0.6064548492431641, 0.6063277244567871, 0.6069176077842713, 0.607453191280365, 0.5994984984397889, 0.5996085166931152, 0.5960779070854187, 0.602674376964569, 0.5895985126495361, 0.586794114112854, 0.5921599745750428, 0.5811618983745575, 0.5832101345062256, 0.584799337387085, 0.5883552551269531, 0.576175582408905, 0.5751547873020172, 0.5775696814060212, 0.572571462392807, 0.5744514286518096, 0.5738773226737977, 0.5680950820446015, 0.5734554350376129, 0.5679691970348358, 0.5731058537960052, 0.5689935803413391, 0.5632148027420044, 0.5665621519088745, 0.5610492587089538, 0.5634901642799377, 0.5635676681995392, 0.5667314231395721, 0.5669234335422516, 0.5615673840045929, 0.5592657923698425, 0.5583960533142089, 0.5542227327823639, 0.5540945351123809, 0.5630096137523651, 0.5589944541454315, 0.55768523812294, 0.5553421199321746, 0.5561403632164001, 0.557654219865799, 0.555027174949646, 0.5573713839054107, 0.5535606741905212, 0.5536427736282349, 0.553658926486969, 0.5570596754550934, 0.5536992728710175, 0.5501315355300903, 0.5508377969264984, 0.5528923571109772, 0.5545616388320923]
    test_accs = [73.6842105263158, 73.6842105263158, 73.6842105263158, 71.05263157894737, 73.6842105263158, 73.6842105263158, 73.6842105263158, 76.3157894736842, 71.05263157894737, 73.6842105263158, 76.3157894736842, 73.6842105263158, 71.05263157894737, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 76.3157894736842, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158]
    fit_results.append(FitResult(n_epochs, train_losses, train_accs, test_losses, test_accs))

    train_losses = [0.6768931495515924, 0.6783963661444815, 0.6678132257963482, 0.6613722914143613, 0.67299968631644, 0.6879386117583827, 0.6576991928251166, 0.6577497061930204, 0.6550332182332089, 0.6472053778798956, 0.6370903033959238, 0.6511968907557035, 0.6422365213695326, 0.6424315979606227, 0.6326400794480976, 0.6378932187431737, 0.6331930631085446, 0.6173604601307919, 0.6193259797598186, 0.6256798097961828, 0.626850570503034, 0.6213845955698114, 0.6096573440652144, 0.6089651270916587, 0.6238312470285516, 0.608386450692227, 0.6178373851274189, 0.6210882130422091, 0.6117156947913923, 0.6071270861123738, 0.5996353030204773, 0.6026648894736641, 0.5950806799687838, 0.6061061855993772, 0.5945947609449688, 0.6048665642738342, 0.6030268198565433, 0.6018563163907904, 0.592028238271412, 0.6013607853337338, 0.608552518643831, 0.5958106094285062, 0.5936828459564009, 0.5955404607873214, 0.5883116596623471, 0.5946375084550757, 0.5927256753570155, 0.5964011204870123, 0.5760555141850522, 0.5910430409406361, 0.5919584192727742, 0.5844157165602634, 0.5830125338152835, 0.6068395564430639, 0.5836067497730255, 0.5808487691377339, 0.5855164543578499, 0.5947741552403099, 0.5913145761740836, 0.5882268861720437]
    train_accs = [60.0, 56.0, 58.666666666666664, 62.0, 58.666666666666664, 52.666666666666664, 65.33333333333333, 63.333333333333336, 64.0, 64.0, 70.66666666666667, 64.66666666666667, 66.66666666666667, 69.33333333333333, 68.0, 67.33333333333333, 72.0, 75.33333333333333, 74.66666666666667, 70.66666666666667, 70.66666666666667, 72.66666666666667, 70.0, 73.33333333333333, 71.33333333333333, 74.0, 70.66666666666667, 72.0, 72.0, 72.66666666666667, 75.33333333333333, 71.33333333333333, 73.33333333333333, 72.0, 72.0, 73.33333333333333, 72.0, 68.0, 74.66666666666667, 74.0, 72.0, 73.33333333333333, 72.0, 72.66666666666667, 72.66666666666667, 72.66666666666667, 72.66666666666667, 72.0, 75.33333333333333, 72.66666666666667, 70.66666666666667, 74.66666666666667, 75.33333333333333, 72.66666666666667, 72.66666666666667, 74.66666666666667, 72.66666666666667, 70.66666666666667, 71.33333333333333, 72.0]
    test_losses = [0.6897412538528442, 0.6788325667381286, 0.6664545178413391, 0.6691980719566345, 0.6613819241523743, 0.6580417275428772, 0.6488292455673218, 0.6522760152816772, 0.6470638155937195, 0.6413488984107971, 0.6322508096694947, 0.6357516050338745, 0.631951379776001, 0.6377665758132934, 0.6188089609146118, 0.6184640169143677, 0.6283849835395813, 0.624030077457428, 0.6154451131820678, 0.6176372647285462, 0.6182291269302368, 0.618170154094696, 0.6140226721763611, 0.6048789978027344, 0.6082948923110962, 0.6030808091163635, 0.6027907609939576, 0.6051135778427124, 0.598443603515625, 0.5935261964797973, 0.600258469581604, 0.5913514852523803, 0.5975920915603637, 0.5972071766853333, 0.5949257254600525, 0.5957901954650879, 0.5951332211494446, 0.5920048952102661, 0.5845013320446014, 0.5862841486930848, 0.5908923387527466, 0.5862013459205627, 0.5869779944419861, 0.5854974389076233, 0.5852746665477753, 0.5859205961227417, 0.5828942060470581, 0.5826042294502258, 0.5760230123996735, 0.5784455358982086, 0.5793027877807617, 0.5785239815711976, 0.5819592893123626, 0.5734099984169007, 0.5751042008399964, 0.5718577265739441, 0.5755131900310516, 0.5771488189697266, 0.5702599227428437, 0.5740601360797882]
    test_accs = [47.36842105263158, 63.1578947368421, 60.526315789473685, 63.1578947368421, 60.526315789473685, 60.526315789473685, 60.526315789473685, 65.78947368421052, 65.78947368421052, 65.78947368421052, 68.42105263157895, 68.42105263157895, 68.42105263157895, 65.78947368421052, 76.3157894736842, 73.6842105263158, 71.05263157894737, 63.1578947368421, 65.78947368421052, 73.6842105263158, 65.78947368421052, 71.05263157894737, 71.05263157894737, 76.3157894736842, 73.6842105263158, 76.3157894736842, 76.3157894736842, 73.6842105263158, 76.3157894736842, 73.6842105263158, 73.6842105263158, 73.6842105263158, 78.94736842105263, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158, 73.6842105263158]
    fit_results.append(FitResult(n_epochs, train_losses, train_accs, test_losses, test_accs))

    fig = None
    for fit_res, model_name in zip(fit_results, res_names):
        fig, _ = plot_fit(fit_res, fig=fig, legend=model_name)

    fig.suptitle("Training Results")
    plt.savefig(f"graphs/Training_Results.png")
    plt.show()
